
[
    {
        "id": "pbc_teacher_referral_code",
        "name": "teacher_refferal_code",
        "type": "base",
        "system": false,
        "listRule": "@request.auth.id != \"\" && teacher = @request.auth.id",
        "viewRule": "@request.auth.id != \"\" && teacher = @request.auth.id",
        "createRule": "@request.auth.id != \"\" && @request.data.teacher:isset && @request.data.teacher = @request.auth.id",
        "updateRule": "@request.auth.id != \"\" && teacher = @request.auth.id",
        "deleteRule": "@request.auth.id != \"\" && teacher = @request.auth.id",
        "schema": [
            {
                "id": "text_trc_id",
                "name": "id",
                "type": "text",
                "system": true,
                "required": true,
                "presentable": false,
                "options": { "min": 15, "max": 15, "pattern": "^[a-z0-9]+$", "autogeneratePattern": "[a-z0-9]{15}" }
            },
            {
                "id": "relation_trc_teacher",
                "name": "teacher",
                "type": "relation",
                "system": false,
                "required": true,
                "presentable": false,
                "options": {
                    "collectionId": "pbc_2504364897",
                    "cascadeDelete": false,
                    "minSelect": 1,
                    "maxSelect": 1,
                    "displayFields": null
                }
            },
            {
                "id": "text_trc_code_string",
                "name": "referral_code_string",
                "type": "text",
                "system": false,
                "required": true,
                "presentable": true,
                "unique": true,
                "options": { "min": 5, "max": 20, "pattern": "^[A-Z0-9]+$" }
            },
            {
                "id": "number_trc_discount",
                "name": "discount_percentage",
                "type": "number",
                "system": false,
                "required": true,
                "presentable": true,
                "options": { "min": 0, "max": 100, "noDecimal": false }
            },
            {
                "id": "relation_trc_applicable_plans",
                "name": "applicable_plan_ids",
                "type": "relation",
                "system": false,
                "required": true, 
                "presentable": false,
                "options": {
                    "collectionId": "pbc_3477515458",
                    "cascadeDelete": false,
                    "minSelect": 1, 
                    "maxSelect": 999,
                    "displayFields": ["Plan_name"]
                }
            },
            {
                "id": "date_trc_expiry",
                "name": "expiry_date",
                "type": "date",
                "system": false,
                "required": false,
                "presentable": true,
                "options": { "min": "", "max": "" }
            },
            {
                "id": "date_trc_created",
                "name": "created",
                "type": "date",
                "system": true, "required": false, "presentable": false,
                "options": { "min": "", "max": ""}
            },
            {
                "id": "date_trc_updated",
                "name": "updated",
                "type": "date",
                "system": true, "required": false, "presentable": false,
                "options": { "min": "", "max": ""}
            }
        ],
        "indexes": [
            "CREATE UNIQUE INDEX idx_trc_code_string ON teacher_refferal_code (referral_code_string)"
        ]
    }
]
