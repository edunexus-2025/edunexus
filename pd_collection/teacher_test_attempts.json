
[
  {
    "id": "pbc_teacher_test_attempts",
    "name": "teacher_test_attempts",
    "type": "base",
    "system": false,
    "listRule": "@request.auth.id != \"\" && (student = @request.auth.id || teacher = @request.auth.id)",
    "viewRule": "@request.auth.id != \"\" && (student = @request.auth.id || teacher = @request.auth.id)",
    "createRule": "@request.auth.id != \"\" && @request.data.student:isset && @request.data.student = @request.auth.id",
    "updateRule": "@request.auth.id != \"\" && student = @request.auth.id && status = \"in_progress\"",
    "deleteRule": "@request.auth.role = \"Admin\"",
    "schema": [
      {
        "id": "tta_id_pk",
        "name": "id",
        "type": "text",
        "system": true,
        "required": true,
        "presentable": false,
        "options": { "min": 15, "max": 15, "pattern": "^[a-z0-9]+$", "autogeneratePattern": "[a-z0-9]{15}" }
      },
      {
        "id": "tta_student_rel",
        "name": "student",
        "type": "relation",
        "required": true,
        "system": false,
        "options": {
          "collectionId": "pbc_1377172174", 
          "cascadeDelete": true,
          "minSelect": 1,
          "maxSelect": 1,
          "displayFields": ["id", "name", "email"]
        }
      },
      {
        "id": "tta_teacher_test_rel",
        "name": "teacher_test",
        "type": "relation",
        "required": true,
        "system": false,
        "options": {
          "collectionId": "pbc_2863365490", 
          "cascadeDelete": false,
          "minSelect": 1,
          "maxSelect": 1,
          "displayFields": ["id", "testName"]
        }
      },
      {
        "id": "tta_teacher_rel",
        "name": "teacher",
        "type": "relation",
        "required": true,
        "system": false,
        "options": {
          "collectionId": "pbc_2504364897", 
          "cascadeDelete": false,
          "minSelect": 1,
          "maxSelect": 1,
          "displayFields": ["id", "name", "EduNexus_Name"]
        }
      },
      {
        "id": "tta_test_name_cache",
        "name": "test_name_cache",
        "type": "text",
        "required": false,
        "system": false,
        "options": { "min": null, "max": 150, "pattern": "" }
      },
      {
        "id": "tta_plan_type_cache",
        "name": "plan_type_cache",
        "type": "text",
        "required": false,
        "system": false,
        "options": { "min": null, "max": 50, "pattern": "" }
      },
      {
        "id": "tta_score_num",
        "name": "score",
        "type": "number",
        "required": true,
        "system": false,
        "options": { "min": null, "max": null, "noDecimal": false }
      },
      {
        "id": "tta_max_score_num",
        "name": "max_score",
        "type": "number",
        "required": true,
        "system": false,
        "options": { "min": 0, "max": null, "noDecimal": false }
      },
      {
        "id": "tta_percentage_num",
        "name": "percentage",
        "type": "number",
        "required": false,
        "system": false,
        "options": { "min": 0, "max": 100, "noDecimal": false }
      },
      {
        "id": "tta_status_select",
        "name": "status",
        "type": "select",
        "required": true,
        "system": false,
        "options": {
          "maxSelect": 1,
          "values": ["completed", "in_progress", "terminated_time_up"]
        }
      },
      {
        "id": "tta_started_at_date",
        "name": "started_at",
        "type": "date",
        "required": true,
        "system": false,
        "options": { "min": "", "max": "" }
      },
      {
        "id": "tta_completed_at_date",
        "name": "completed_at",
        "type": "date",
        "required": false,
        "system": false,
        "options": { "min": "", "max": "" }
      },
      {
        "id": "tta_duration_taken_num",
        "name": "duration_taken_seconds",
        "type": "number",
        "required": false,
        "system": false,
        "options": { "min": 0, "noDecimal": true }
      },
      {
        "id": "tta_answers_log_json",
        "name": "answers_log",
        "type": "json",
        "required": false,
        "system": false,
        "options": { "maxSize": 1048576 } 
      },
      {
        "id": "tta_total_qs_cache_num",
        "name": "total_questions_in_test_cache",
        "type": "number",
        "required": false,
        "system": false,
        "options": { "min": 0, "noDecimal": true }
      },
      {
        "id": "tta_attempted_count_num",
        "name": "attempted_questions_count",
        "type": "number",
        "required": false,
        "system": false,
        "options": { "min": 0, "noDecimal": true }
      },
      {
        "id": "tta_correct_count_num",
        "name": "correct_answers_count",
        "type": "number",
        "required": false,
        "system": false,
        "options": { "min": 0, "noDecimal": true }
      },
      {
        "id": "tta_incorrect_count_num",
        "name": "incorrect_answers_count",
        "type": "number",
        "required": false,
        "system": false,
        "options": { "min": 0, "noDecimal": true }
      },
      {
        "id": "tta_unattempted_count_num",
        "name": "unattempted_questions_count",
        "type": "number",
        "required": false,
        "system": false,
        "options": { "min": 0, "noDecimal": true }
      },
      {
        "id": "tta_created_date",
        "name": "created",
        "type": "date",
        "system": true,
        "required": false,
        "options": { "min": "", "max": "" }
      },
      {
        "id": "tta_updated_date",
        "name": "updated",
        "type": "date",
        "system": true,
        "required": false,
        "options": { "min": "", "max": "" }
      }
    ],
    "indexes": [
      "CREATE INDEX idx_tta_student ON teacher_test_attempts (student)",
      "CREATE INDEX idx_tta_teacher_test ON teacher_test_attempts (teacher_test)",
      "CREATE INDEX idx_tta_teacher ON teacher_test_attempts (teacher)"
    ],
    "options": {}
  }
]
    